<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‡ªå­¸å°ˆç”¨-ç¹”åœ–ç”Ÿæˆå™¨-ç©å¶æ•™å­¸ç‰ˆ v4.7</title>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        body { font-family: -apple-system, "Microsoft JhengHei", sans-serif; background-color: #f8f9fa; color: #333; padding: 20px; display: flex; flex-direction: column; align-items: center; }
        .container { background: white; padding: 25px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); max-width: 750px; width: 100%; }
        h2 { color: #d63384; text-align: center; margin-bottom: 20px; }
        
        /* å½±éŸ³æ•™å­¸å€ï¼šå¢åŠ ç¸«åˆ */
        .video-guide { background: #f0f7ff; border: 1px solid #b8daff; padding: 20px; border-radius: 10px; margin-bottom: 30px; }
        .video-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 10px; margin-top: 10px; }
        .video-item { background: white; padding: 10px; border-radius: 8px; text-align: center; border: 1px solid #dee2e6; font-size: 13px; }
        .video-item b { display: block; color: #d63384; margin-bottom: 5px; font-size: 14px; }
        .btn-video { background: #ff4444; color: white; text-decoration: none; padding: 5px 8px; border-radius: 5px; font-size: 11px; display: inline-block; margin-top: 5px; }
        
        /* æˆå“ç¤ºç¯„åœ–æ¨£å¼ */
        .sample-img-container { text-align: center; margin: 15px 0; }
        .sample-img { max-width: 100%; border-radius: 10px; border: 3px solid #f8d7da; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }

        .code-tag-mr { background: #d63384; color: white; padding: 1px 6px; border-radius: 4px; font-weight: bold; font-family: monospace; }
        
        .ratio-intro { background: #fffaf0; border: 1px solid #ffeeba; padding: 20px; border-radius: 10px; margin-bottom: 30px; }
        .ratio-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; font-size: 14px; margin-top: 10px; }
        .ratio-item { background: white; padding: 8px; border-radius: 5px; border-left: 4px solid #ffc107; }

        .config-section { background: #fff5f8; padding: 20px; border-radius: 10px; margin-bottom: 20px; border: 1px solid #f8d7da; text-align: center; }
        .btn-generate { background-color: #d63384; color: white; border: none; padding: 15px; border-radius: 8px; cursor: pointer; font-size: 18px; font-weight: bold; width: 80%; }
        
        .part-card { margin-top: 40px; border: 1px solid #eee; padding: 20px; border-radius: 12px; background: #fff; }
        .part-header { border-bottom: 2px solid #d63384; margin-bottom: 15px; display: flex; justify-content: space-between; align-items: baseline; }
        .tech-note { background: #e8f4fd; padding: 12px; border-radius: 6px; font-size: 14px; margin-bottom: 15px; border-left: 4px solid #2196f3; line-height: 1.6; }
        
        table { width: 100%; border-collapse: collapse; margin-bottom: 15px; }
        th, td { border: 1px solid #f8d7da; padding: 10px; text-align: center; font-size: 14px; }
        th { background-color: #fff0f3; color: #d63384; }
        .done-row { background-color: #f2f2f2 !important; color: #aaa; text-decoration: line-through; }
        
        .edit-btns { display: flex; gap: 4px; justify-content: center; }
        .btn-edit { border: none; border-radius: 4px; padding: 4px 8px; cursor: pointer; font-size: 12px; }
        .btn-add { background: #e3f2fd; color: #1976d2; }
        .btn-del { background: #ffebee; color: #c62828; }

        .assembly-guide { background: #f0fff4; border: 1px solid #c3e6cb; padding: 20px; border-radius: 10px; margin-top: 40px; }
    </style>
</head>
<body>

<div class="container">
    <h2>ğŸ§¸ ç©å¶DIYç¹”åœ–ç”Ÿæˆå™¨</h2>

    <div class="video-guide">
        <h3 style="margin-top:0; color: #0056b3;">ğŸ“¹ åŸºç¤é‡æ³•èˆ‡ä»£è™Ÿèªªæ˜</h3>
        <p style="font-size: 14px;">åœ¨é€²å…¥ç¹”åœ–å‰ï¼Œè«‹å…ˆç¢ºèªæ‚¨äº†è§£æ¯å€‹ä»£è™Ÿä»£è¡¨çš„å‹•ä½œï¼š</p>
        <div class="video-grid">
            <div class="video-item">
                <b>MR ç’°ç‹€èµ·é‡</b>
                <span>é›¶ä»¶èµ·å§‹è™•</span>
                <a href="https://www.youtube.com/results?search_query=é‰¤é‡+ç’°ç‹€èµ·é‡+å°ç£" target="_blank" class="btn-video">â–¶ æ•™å­¸å½±ç‰‡</a>
            </div>
            <div class="video-item">
                <b>X çŸ­é‡</b>
                <span>åŸºç¤å¹³ç¹”é‡</span>
                <a href="https://www.youtube.com/results?search_query=é‰¤é‡+çŸ­é‡+æ•™å­¸" target="_blank" class="btn-video">â–¶ æ•™å­¸å½±ç‰‡</a>
            </div>
            <div class="video-item">
                <b style="color:#28a745;">V åŠ é‡</b>
                <span>1å€‹é‡ç›®é‰¤2é‡</span>
                <a href="https://www.youtube.com/results?search_query=é‰¤é‡+åŠ é‡+æ•™å­¸" target="_blank" class="btn-video">â–¶ æ•™å­¸å½±ç‰‡</a>
            </div>
            <div class="video-item">
                <b style="color:#dc3545;">A æ¸›é‡</b>
                <span>2å€‹é‡ç›®ç¸®ç‚º1é‡</span>
                <a href="https://www.youtube.com/results?search_query=é‰¤é‡+æ¸›é‡+æ•™å­¸" target="_blank" class="btn-video">â–¶ æ•™å­¸å½±ç‰‡</a>
            </div>
            <div class="video-item">
                <b>ğŸ§µ ç¸«åˆæŠ€è¡“</b>
                <span>é›¶ä»¶çµ„è£æ–¹æ³•</span>
                <a href="https://www.youtube.com/results?search_query=é‰¤é‡+ç©å¶+ç¸«åˆ+æ•™å­¸+å°ç£" target="_blank" class="btn-video">â–¶ æ•™å­¸å½±ç‰‡</a>
            </div>
        </div>
    </div>

    <div class="ratio-intro">
        <h3 style="margin-top:0; color: #856404;">Step 1: äº†è§£ç©å¶éƒ¨ä½æ¯”ä¾‹</h3>
        <div class="sample-img-container">
            <img src="sample.jpg" alt="æˆå“ç¯„ä¾‹" class="sample-img">
            <p style="font-size: 12px; color: #d63384; margin-top: 5px;">â–² å¯¦ä½œåƒè€ƒç¯„ä¾‹ï¼šä»¥ä¸€å®šèƒ½é‰¤çš„æ¯”é€™å€‹æ›´å¯æ„›!</p>
        </div>
        <div class="ratio-grid">
            <div class="ratio-item"><b>é ­éƒ¨ï¼š</b>ä½”å…¨é«˜ 1/3ã€‚</div>
            <div class="ratio-item"><b>èº«é«”ï¼š</b>ä½”å…¨é«˜ 1/3ã€‚</div>
            <div class="ratio-item"><b>è…¿éƒ¨ï¼š</b>ä½”å…¨é«˜ 1/3ã€‚</div>
            <div class="ratio-item"><b>æ‰‹éƒ¨ï¼š</b>é•·åº¦ç´„ç‚ºèº«é«”çš„ 3/4ã€‚</div>
        </div>
    </div>

    <div class="config-section">
        <div style="margin-bottom:15px;">
            <label style="font-weight:bold;">è¼¸å…¥ç©å¶ç¸½é«˜åº¦ (cm): </label>
            <input type="number" id="totalHeight" value="12" style="width:80px; text-align:center;">
        </div>
        <button class="btn-generate" onclick="generateDoll()">ç”Ÿæˆå„éƒ¨ä½ Step by Step ç¹”åœ–</button>
    </div>

    <div id="tutorial-content"></div>

    <div id="assembly-section" class="assembly-guide" style="display:none;">
        <h3>Step 3: çµ„è£èˆ‡ç¸«åˆé‡é»</h3>
        <ul style="font-size: 14px; line-height: 1.8;">
            <li><b>å°é½Šç¸«åˆï¼š</b>å°‡é ­éƒ¨èˆ‡èº«é«”çš„ 12 é‡é–‹å£å°é½Šç¸«åˆã€‚</li>
            <li><b>æ‰‹éƒ¨å®‰è£ï¼š</b>å›ºå®šåœ¨è„–å­ä¸‹æ–¹ç¬¬ 1-2 åœˆè™•ã€‚</li>
            <li><b>è…¿éƒ¨å®‰è£ï¼š</b>ç¸«åœ¨èº«é«”åº•éƒ¨ä¸­å¤®åå‰çš„ä½ç½®ã€‚</li>
            <li><b>é«®ç¶²å›ºå®šï¼š</b>å¥—åœ¨é ­éƒ¨èª¿æ•´å¥½ä½ç½®å¾Œå†é€²è¡Œç¸«åˆã€‚</li>
        </ul>
    </div>
</div>

<script>
// JS é‚è¼¯ä¿æŒ v4.6 ç‰ˆæœ¬
function formatLogic(logic) {
    return logic.replace(/MR/g, function(match) {
        return `<span class="code-tag-mr">${match}</span>`;
    });
}

let dollData = {
    head: { name: "éƒ¨ä½ A: é ­éƒ¨ (Head)", dRatio: 0.33, lRatio: 0.33, mr: 6, stop: 12, qty: 1, note: "æ¨™æº–çƒé«”ã€‚åœåœ¨ 12 é‡ä»¥åˆ©ç¸«åˆã€‚" },
    body: { name: "éƒ¨ä½ B: èº«é«” (Body)", dRatio: 0.25, lRatio: 0.33, mr: 6, stop: 12, qty: 1, note: "ä¸Šæ–¹ä¿ç•™ 12 é‡ï¼Œå¡æ£‰èŠ±å¾Œèˆ‡é ­éƒ¨ç¸«åˆã€‚" },
    arm:  { name: "éƒ¨ä½ C: æ‰‹éƒ¨ (Arms)", dRatio: 0.16, lRatio: 0.25, mr: 4, stop: 4,  qty: 2, note: "4 é‡èµ·é ­ï¼Œä¸é ˆæ¸›é‡ï¼Œç•™é•·ç·šé ­ç¸«åˆã€‚" },
    leg:  { name: "éƒ¨ä½ D: è…¿éƒ¨ (Legs)", dRatio: 0.16, lRatio: 0.33, mr: 4, stop: 4,  qty: 2, note: "æ”¯æ’é«˜åº¦çš„é—œéµã€‚åå§¿å¨ƒå¨ƒé ‚éƒ¨å¯ä¸å¡æ£‰èŠ±ã€‚" },
    hair: { name: "éƒ¨ä½ E: é«®ç¶² (Hair Cap)", dRatio: 0.35, lRatio: 0.20, mr: 6, stop: 0,  qty: 1, note: "é«®å‹åŸºåº•ï¼Œç›´å¾‘æ¯”é ­éƒ¨ç•¥å¤§ä¸€é»é»ã€‚" }
};

function toggleRow(checkbox) { checkbox.closest('tr').classList.toggle('done-row', checkbox.checked); }
function renumber(tbody) { Array.from(tbody.rows).forEach((row, i) => row.cells[1].innerText = i + 1); }
function addRow(btn) {
    const cur = btn.closest('tr'); 
    const st = cur.cells[3].innerText; 
    const nr = document.createElement('tr');
    nr.innerHTML = `<td><input type="checkbox" onchange="toggleRow(this)"></td><td></td><td>${st}X <small>(æ‰‹å‹•åŠ æ’)</small></td><td>${st}</td><td class="edit-btns"><button class="btn-edit btn-add" onclick="addRow(this)">â•</button><button class="btn-edit btn-del" onclick="this.closest('tr').remove(); renumber(cur.parentNode)">âŒ</button></td>`;
    cur.parentNode.insertBefore(nr, cur.nextSibling); 
    renumber(cur.parentNode);
}

function createTable(part, D, L) {
    const base = part.mr; const targetRounds = Math.round(D); const maxSt = targetRounds * base;
    let html = `<div class="part-card">
        <div class="part-header"><h3>${part.name}</h3><span style="color:#d63384; font-weight:bold;">è£½ä½œæ•¸é‡: ${part.qty}</span></div>
        <div class="tech-note"><b>ğŸ’¡ æ•™å­¸é‡é»ï¼š</b>${part.note}</div>
        <table><thead><tr><th>å®Œ</th><th>åœˆ</th><th>é‡æ³•é‚è¼¯</th><th>ç¸½é‡</th><th>èª¿æ•´</th></tr></thead><tbody>`;
    let rows = [];
    const getRow = (l, s) => `<tr><td><input type="checkbox" onchange="toggleRow(this)"></td><td></td><td>${formatLogic(l)}</td><td>${s}</td><td class="edit-btns"><button class="btn-edit btn-add" onclick="addRow(this)">â•</button></td></tr>`;
    
    rows.push(getRow(`MR (${base}X)`, base));
    for (let i = 2; i <= targetRounds; i++) rows.push(getRow(i===2?`${base}V`:`(${i-2}X, V)*${base}`, i*base));
    let mid = Math.max(1, Math.round((L - D/2) * 2));
    if (part.name.includes("Hair")) mid += 2;
    for(let i=0; i<mid; i++) rows.push(getRow(maxSt+"X", maxSt));
    if (part.stop > 0) {
        for (let i = targetRounds; i >= 2; i--) {
            let nextSt = (i - 1) * base;
            if (nextSt < part.stop) break;
            rows.push(getRow(i===2?`${base}A`:`(${i-2}X, A)*${base}`, nextSt));
            if (nextSt === part.stop) break;
        }
    }
    return html + rows.join('') + `</tbody></table></div>`;
}

function generateDoll() {
    const H = parseFloat(document.getElementById('totalHeight').value) || 12;
    const container = document.getElementById('tutorial-content');
    container.innerHTML = createTable(dollData.head, H*0.33, H*0.33) + 
                          createTable(dollData.body, H*0.25, H*0.33) + 
                          createTable(dollData.arm,  H*0.16, H*0.25) + 
                          createTable(dollData.leg,  H*0.16, H*0.33) + 
                          createTable(dollData.hair, H*0.35, H*0.20);
    document.querySelectorAll('tbody').forEach(tb => renumber(tb));
    document.getElementById('assembly-section').style.display = 'block';
}
</script>
</body>

</html>


